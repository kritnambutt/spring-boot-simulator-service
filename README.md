<p align="center">
  <h1 align="center" style="color:pink">ðŸ¤– Simulators ðŸ¤– </h1>
  <p align="center">
    <br/>
    This project is a maven project that generates a spring boot application that can be used to simulate the AIA+ APIs for the Backend For Frontend.
  </p>
  <br/>
</p>

## Overview
---

**OpenAPI 3.0** specification files are used to generate the simulator server. Please refer to https://swagger.io/specification/ on how to correctly configure the specification yaml file.

It is reccommnended that [Stoplight Studio](https://stoplight.io/studio) is used. This tool will help you create the specification file and also generate the required .json files for the responses.

## Usage
---

1. Update the the OpenAPI specification yaml file in the `./openapi-specs/` directory according the openAPI specifications recieved from the client.

2. Run the following scripts to generate the simulator server code move the generated code from the target directory to the src directory.
```
 cd ./scripts
 sh generate-simulator-server.sh
```

3. In `./src/main/resources/responses` folder. create the required .json files for the responses of the endpoints in the simulator.

4. If a new endpoint is created under an existing service, create or update a new controller class in the `./src/main/java/com/aiaplushk/controllers/` directory.

5. Override the required methods in the controller class, add the required controller logics, return the required response from the response .json file.

## Simulator Controllers

This section will describe how to write the controller classes for the simulator.

1. The controller must implement the service's ApiDelegate interface.

2. The controller must be annotated with `@Component` so that it can be autowired by the spring framework.

3. The controller must have a constructor that assigns the fileReader to a private variable.

4. The controller must override the required methods from the ApiDelegate interface and return the required response.

```java

@Component
public class ExampleController implements ServiceApiDelegate {
    private final FileReader fileReader;

    public ExampleController(FileReader fileReader) {
        this.fileReader = fileReader;
    }

    @Override
    public ResponseEntity<String> serviceEndpointMethod() {
        // Add controller logic here. e.g. call a service and return the response, error handling
        // happy and unhappy cases 

        String response = fileReader.getResponse("<path-to-json-response-file>");
        return new ResponseEntity<>(response, HttpStatus.OK);
    }
}

```

notes: 
 - The `fileReader` is a utility class that reads the .json files from the `./src/main/resources/responses` directory.

 - The methods available to be overriden are the methods in the ApiDelegate interface file. The methods are generated by the openapi-generator-maven-plugin.

